	<script type="text/javascript"><!--	var maximumTabId = {MAXTABID};	var viewArray = new Array(		{FOR_VIEWS {id:"{VIEW_ID}",name:"{VIEW_NAME}"}{COMMA} FOR_VIEWS}	);	var tabiconArray = new Array(		{FOR_TABICONS {name:"{ICON_NAME}",filename:"{ICON_FILENAME}"}, FOR_TABICONS}	);	var currentEditedTabIcon = 0;		function createViewList(tabId, viewId)	{		var selectBox = document.createElement('select');		selectBox.setAttribute('name', 'tabbar_view_' + tabId);		selectBox.setAttribute('class', 'tab_container_view');		for(var i = 0; i < viewArray.length; i++)		{			var optionField = document.createElement('option');			optionField.setAttribute('value', viewArray[i]["id"]);			if(viewId >= 0 && viewArray[i]["id"] == viewId)				optionField.setAttribute('selected', 'selected')			optionField.innerHTML = viewArray[i]["name"];						selectBox.appendChild(optionField);		}		return selectBox;	}		function createTabIconList(element, tabId)	{		currentEditedTabIcon = tabId;		var currentElement = element;		var topPosition = 0;		var leftPosition = 0;		while(currentElement.offsetParent != null) {			topPosition += currentElement.offsetTop;			currentElement = currentElement.offsetParent;		}		currentElement = element;				while(currentElement.offsetParent != null) {			leftPosition += currentElement.offsetLeft;			currentElement = currentElement.offsetParent;		}				var tabiconContainer = document.getElementById('tabicon_selection');		if(document.getElementById('tabicon_selection') == null)		{			tabiconContainer = document.createElement('div');			tabiconContainer.setAttribute('id', 'tabicon_selection');			tabiconContainer.style.width = '300px';			tabiconContainer.style.height = '200px';			tabiconContainer.style.backgroundColor = '#000000';			tabiconContainer.style.padding = '5px';			tabiconContainer.style.border = '1px solid silver';			tabiconContainer.style.overflow = 'scroll';			var i = 0;			var arrayId = 0;			for(i = 0; i < tabiconArray.length; i++)			{				var currentTabIcon = document.createElement('img');				currentTabIcon.setAttribute('class', 'tabbar_icon_selection');				arrayId = i;				currentTabIcon.style.padding = '2px';				currentTabIcon.onclick = (function(arrayId) { return function()					{						document.getElementById('tabbar_icon_preview_' + currentEditedTabIcon).src = 'images/tabbar/' + tabiconArray[arrayId]["filename"];						document.getElementById('tabbar_icon_' + currentEditedTabIcon).value = tabiconArray[arrayId]["filename"];						document.getElementById('tabicon_selection').style.display = 'none';					};})(i);				currentTabIcon.src = 'images/tabbar/' + tabiconArray[i]["filename"];								tabiconContainer.appendChild(currentTabIcon);			}			document.body.appendChild(tabiconContainer);		}		tabiconContainer.style.display = 'block';		tabiconContainer.style.position = 'absolute';		tabiconContainer.style.top = topPosition+'px';		tabiconContainer.style.left = leftPosition+'px';		tabiconContainer.style.zIndex = 1000;	}		/*	---------------------------------	creates a new tab	---------------------------------	*/	function createNewTab()	{		maximumTabId++;		createTab(maximumTabId, -1, false, false);		document.getElementById('maximumtabid').value = maximumTabId;	}		/*	---------------------------------	creates a new tab	---------------------------------	*/	function removeTab(tabId)	{		// check if tab was default tab		if(document.getElementById('tabbar_view_default_' + tabId).checked == true)		{			// search for first tab to make it the new default			for(var i = 0; i <= maximumTabId; i++)			{				if(document.getElementById('tabbar_view_default_' + i) != null && i != tabId)				{					document.getElementById('tabbar_view_default_' + i).checked = true;					setDefaultTab(i);					break;				}			}		}			var tabContainer = document.getElementById('tab_container_' + tabId);		tabContainer.parentNode.removeChild(tabContainer);		// if the last tab is deleted, simplify by decrementing the maximum		if(tabId == maximumTabId)		{			maximumTabId--;		}	}		/*	---------------------------------	sets a tab default	---------------------------------	*/	function setDefaultTab(tabId)	{		for(var i = 0; i <= maximumTabId; i++)		{			if(document.getElementById('tabbar_view_default_' + i) != null)			{				if(tabId == i)				{					document.getElementById('tab_container_' + i).className += ' tab_container_default';				}				else				{					document.getElementById('tabbar_view_default_' + i).checked = false;					document.getElementById('tab_container_' + i).className = 						document.getElementById('tab_container_' + i).className.replace(/ tab_container_default/g, '');				}			}		}	}		/*	---------------------------------	creates a tab with the given data	---------------------------------	@param: tabId		the tabid for this tab (does NOT resemble the (current) position!)	@param: viewId		the default selected view for this tab. If no one selected, pass -1	@param defaultTab		is this tab the default tab?	*/	function createTab(tabId, viewId, defaultTab, currentIcon)	{		var tabContainer = document.getElementById('tab_container_global');				var divNewTab = document.createElement('div');		divNewTab.setAttribute('id', 'tab_container_' + tabId);				divNewTab.setAttribute('class', 'tab_container_single' + (defaultTab ? ' tab_container_default' : ''));				/*		========		default tab		========		*/		var inputDefaultTab = document.createElement('input');		inputDefaultTab.setAttribute('type', 'checkbox');		inputDefaultTab.setAttribute('name', 'tabbar_view_default_' + tabId);		inputDefaultTab.setAttribute('id', 'tabbar_view_default_' + tabId);		inputDefaultTab.setAttribute('value', 'front');		inputDefaultTab.onchange = function() { setDefaultTab(tabId); };		if(defaultTab)			inputDefaultTab.setAttribute('checked', 'checked');		divNewTab.appendChild(inputDefaultTab);				/*		===========		remove link		===========		*/		var removeLink = document.createElement('a');		removeLink.setAttribute('href', 'javascript:void();');		removeLink.onclick = function() { removeTab(tabId); };		var removeImage = document.createElement('img');		removeImage.setAttribute('src', 'templates/default/grafix/disabled.png');		removeLink.appendChild(removeImage);				divNewTab.appendChild(removeLink);				/*		========		tab icon		========		*/				var divTabiconInput = document.createElement('div');		divTabiconInput.setAttribute('class', 'tab_container_icon');		var tabiconLink = document.createElement('a');		tabiconLink.setAttribute('href', 'javascript:void(0)');		tabiconLink.onclick = function() { createTabIconList(tabiconLink, tabId); };		var tabiconCurrentPreview = document.createElement('img');			tabiconCurrentPreview.setAttribute('src', 'images/tabbar/' + (currentIcon == false ? tabiconArray[0]["filename"] : currentIcon[0]));			tabiconCurrentPreview.setAttribute('alt', '{LANG:tabicon_alttext}');			tabiconCurrentPreview.setAttribute('id', 'tabbar_icon_preview_' + tabId);		tabiconLink.appendChild(tabiconCurrentPreview);		divTabiconInput.appendChild(tabiconLink);				var tabiconHidden = document.createElement('input');		tabiconHidden.setAttribute('type', 'hidden');		tabiconHidden.setAttribute('name', 'tabbar_icon_' + tabId);		tabiconHidden.setAttribute('id', 'tabbar_icon_' + tabId);		tabiconHidden.setAttribute('value', (currentIcon == false ? tabiconArray[0]["filename"] : currentIcon[0]));				divNewTab.appendChild(divTabiconInput);		divNewTab.appendChild(tabiconHidden);				/*		========		tab view		========		*/				var divTabviewInput = document.createElement('div');		divTabviewInput.appendChild(createViewList(tabId, viewId));		divNewTab.appendChild(divTabviewInput);				tabContainer.appendChild(divNewTab);	}		--></script>	<h1>TabBar</h1>		<style type="text/css">		#tab_container_global		{			background-image: url(images/devices/tabbar_background.png);			background-repeat: repeat-x;			height: 117px;			width: 100%;			overflow: scroll;			white-space: nowrap;			overflow-y: hidden;		}		.tab_container_single		{			width: 75px;			text-align: center;			padding: 10px 0px;			display: inline-block;		}		.tab_container_default		{			background-image: url(images/devices/tabbar_background_left.png), url(images/devices/tabbar_background_right.png), url(images/devices/tabbar_background_active.png);			background-position: center left, center right, 10px center;			background-repeat: no-repeat, no-repeat, repeat-x;		}		.tab_container_icon		{			padding: 5px;			height: 30px;		}		.tab_container_view		{			width: 70px;			background-color: black;			color: white;			font-size: 12px;			font-weight: bold;			border: 0px;		}	</style>		<form action="index.php">			<input type="hidden" name="m" value="tabbar" />		<input type="hidden" name="view_id" value="{VIEWID}" />		<input type="hidden" name="submit" value="form" />		<input type="hidden" name="maximumtabid" value="{MAXTABID}" id="maximumtabid" />				<div class="content_form_text">Name:</div>		<div class="content_form_input"><input class="content_form_input_field" type="text" name="tabbar_name" value="{TABBAR_NAME}" /></div>		<div class="content_form_details">{LANG:helptext_tabbar_name}</div>				<h2>Tabs</h2>				<div id="tab_container_global"></div>				<a href="javascript:void(0)" onclick="createNewTab()"><img src="templates/default/grafix/plus.png"> {LANG:createnewtab}</a>			<div class="content_submit_button">			<input type="submit" value="{LANG:submit}" />		</div>	</form>		<script type="text/javascript"><!--	{FOR_TABS	createTab({TAB_ID}, {TAB_VIEW_ID}, {DEFAULT_TAB}, {TAB_ICON});	FOR_TABS}	--></script>