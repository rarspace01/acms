	<script type="text/javascript"><!--	var maximumTabId = {MAXTABID};	var viewArray = new Array(		{FOR_VIEWS {id:"{VIEW_ID}",name:"{VIEW_NAME}"}{COMMA} FOR_VIEWS}	);	var tabiconArray = new Array(		{FOR_TABICONS {name:"{ICON_NAME}",filename:"{ICON_FILENAME}"}, FOR_TABICONS}	);	var currentEditedTabIcon = 0;		function createViewList(tabId, viewId)	{		var selectBox = document.createElement('select');		selectBox.setAttribute('name', 'tabbar_view_' + tabId);		for(var i = 0; i < viewArray.length; i++)		{			var optionField = document.createElement('option');			optionField.setAttribute('value', viewArray[i]["id"]);			if(viewId >= 0 && viewArray[i]["id"] == viewId)				optionField.setAttribute('selected', 'selected')			optionField.innerHTML = viewArray[i]["name"];						selectBox.appendChild(optionField);		}		return selectBox;	}		function createTabIconList(element, tabId)	{		currentEditedTabIcon = tabId;		var currentElement = element;		var topPosition = 0;		var leftPosition = 0;		while(currentElement.offsetParent != null) {			topPosition += currentElement.offsetTop;			currentElement = currentElement.offsetParent;		}		currentElement = element;				while(currentElement.offsetParent != null) {			leftPosition += currentElement.offsetLeft;			currentElement = currentElement.offsetParent;		}				var tabiconContainer = document.getElementById('tabicon_selection');		if(document.getElementById('tabicon_selection') == null)		{			tabiconContainer = document.createElement('div');			tabiconContainer.setAttribute('id', 'tabicon_selection');			tabiconContainer.style.width = '300px';			tabiconContainer.style.height = '200px';			tabiconContainer.style.backgroundColor = '#FFFFFF';			tabiconContainer.style.padding = '5px';			tabiconContainer.style.border = '1px solid silver';			tabiconContainer.style.overflow = 'scroll';			var i = 0;			var arrayId = 0;			for(i = 0; i < tabiconArray.length; i++)			{				var currentTabIcon = document.createElement('img');				currentTabIcon.setAttribute('class', 'tabbar_icon_selection');				arrayId = i;				currentTabIcon.style.padding = '2px';				currentTabIcon.onclick = (function(arrayId) { return function()					{						document.getElementById('tabbar_icon_preview_' + currentEditedTabIcon).src = 'images/tabbar/icons/' + tabiconArray[arrayId]["filename"];						document.getElementById('tabbar_icon_' + currentEditedTabIcon).value = tabiconArray[arrayId]["name"];						document.getElementById('tabicon_selection').style.display = 'none';					};})(i);				currentTabIcon.src = 'images/tabbar/icons/' + tabiconArray[i]["filename"];								tabiconContainer.appendChild(currentTabIcon);			}			document.body.appendChild(tabiconContainer);		}		tabiconContainer.style.display = 'block';		tabiconContainer.style.position = 'absolute';		tabiconContainer.style.top = topPosition+'px';		tabiconContainer.style.left = leftPosition+'px';		tabiconContainer.style.zIndex = 1000;	}		/*	---------------------------------	creates a new tab	---------------------------------	*/	function createNewTab()	{		maximumTabId++;		createTab(maximumTabId, -1, false);		document.getElementById('maximumtabid').value = maximumTabId;	}		/*	---------------------------------	creates a new tab	---------------------------------	*/	function removeTab(tabId)	{		var tabContainer = document.getElementById('tab_container_' + tabId);		tabContainer.parentNode.removeChild(tabContainer);		// if the last tab is deleted, simplify by decrementing the maximum		if(tabId == maximumTabId)		{			maximumTabId--;		}	}		/*	---------------------------------	creates a tab with the given data	---------------------------------	@param: tabId		the tabid for this tab (does NOT resemble the (current) position!)	@param: viewId		the default selected view for this tab. If no one selected, pass -1	@param defaultTab		is this tab the default tab?	*/	function createTab(tabId, viewId, defaultTab, currentIcon)	{		var tabContainer = document.getElementById('tab_container_global');				var divNewTab = document.createElement('div');		divNewTab.setAttribute('id', 'tab_container_' + tabId);				var divDivider = document.createElement('div');		divDivider.style.marginTop = '40px';		divNewTab.appendChild(divDivider);				var removeContainer = document.createElement('div');		var removeLink = document.createElement('a');		removeLink.setAttribute('href', 'javascript:void();');		removeLink.setAttribute('class', 'content_form_input_link');		removeLink.onclick = function() { removeTab(tabId); };		var removeImage = document.createElement('img');		removeImage.setAttribute('src', 'templates/default/grafix/disabled.png');		removeLink.appendChild(removeImage);		removeLink.appendChild(document.createTextNode(' {LANG:removetab}'));		removeContainer.appendChild(removeLink);				divNewTab.appendChild(removeContainer);				/*		========		tab view		========		*/		var divTabviewText = document.createElement('div');		divTabviewText.setAttribute('class', 'content_form_text');		divTabviewText.appendChild(document.createTextNode('{LANG:tabview_selection}'));				var divTabviewInput = document.createElement('div');		divTabviewInput.setAttribute('class', 'content_form_input');		divTabviewInput.appendChild(createViewList(tabId, viewId));				var divTabviewHelp = document.createElement('div');		divTabviewHelp.setAttribute('class', 'content_form_details');		divTabviewHelp.appendChild(document.createTextNode('{LANG:helptext_tabbar_tabview}'));				divNewTab.appendChild(divTabviewText);		divNewTab.appendChild(divTabviewInput);		divNewTab.appendChild(divTabviewHelp);				/*		========		tab icon		========		*/		var divTabiconText = document.createElement('div');		divTabiconText.setAttribute('class', 'content_form_text');		divTabiconText.appendChild(document.createTextNode('{LANG:tabview_icon}'));				var divTabiconInput = document.createElement('div');		divTabiconInput.setAttribute('class', 'content_form_input');		var tabiconLink = document.createElement('a');		tabiconLink.setAttribute('class', 'content_form_input_link');		tabiconLink.setAttribute('href', 'javascript:void(0)');		tabiconLink.onclick = function() { createTabIconList(tabiconLink, tabId); };			var tabiconCurrentPreview = document.createElement('img');			tabiconCurrentPreview.setAttribute('src', 'images/tabbar/icons/' + currentIcon + '.png');			tabiconCurrentPreview.setAttribute('alt', '{LANG:tabicon_alttext}');			tabiconCurrentPreview.setAttribute('id', 'tabbar_icon_preview_' + tabId);		tabiconLink.appendChild(tabiconCurrentPreview);		tabiconLink.appendChild(document.createTextNode(' ({LANG:tabiconchange})'));		divTabiconInput.appendChild(tabiconLink);				var divTabiconHelp = document.createElement('div');		divTabiconHelp.setAttribute('class', 'content_form_details');		divTabiconHelp.appendChild(document.createTextNode('{LANG:helptext_tabbar_tabicon}'));				var tabiconHidden = document.createElement('input');		tabiconHidden.setAttribute('type', 'hidden');		tabiconHidden.setAttribute('name', 'tabbar_icon_' + tabId);		tabiconHidden.setAttribute('id', 'tabbar_icon_' + tabId);		tabiconHidden.setAttribute('value', currentIcon);				divNewTab.appendChild(divTabiconText);		divNewTab.appendChild(divTabiconInput);		divNewTab.appendChild(divTabiconHelp);		divNewTab.appendChild(tabiconHidden);				/*		========		default tab		========		*/		var divDefaultText = document.createElement('div');		divDefaultText.setAttribute('class', 'content_form_text');		divDefaultText.appendChild(document.createTextNode('{LANG:defaulttab}'));				var divDefaultInput = document.createElement('div');		divDefaultInput.setAttribute('class', 'content_form_input');			var inputDefaultTab = document.createElement('input');			inputDefaultTab.setAttribute('type', 'checkbox');			inputDefaultTab.setAttribute('name', 'tabbar_view_default_' + tabId);			inputDefaultTab.setAttribute('value', 'front');			if(defaultTab)				inputDefaultTab.setAttribute('checked', 'checked');		divDefaultInput.appendChild(inputDefaultTab);		divDefaultInput.appendChild(document.createTextNode(' {LANG:yes}'));				var divDefaultHelp = document.createElement('div');		divDefaultHelp.setAttribute('class', 'content_form_details');		divDefaultHelp.appendChild(document.createTextNode('{LANG:helptext_tabbar_defaulttaub}'));		divNewTab.appendChild(divDefaultText);		divNewTab.appendChild(divDefaultInput);		divNewTab.appendChild(divDefaultHelp);				tabContainer.appendChild(divNewTab);	}		--></script>	<h1>TabBar</h1>		<form action="index.php">			<input type="hidden" name="m" value="tabbar" />		<input type="hidden" name="view_id" value="{VIEWID}" />		<input type="hidden" name="submit" value="form" />		<input type="hidden" name="maximumtabid" value="{MAXTABID}" id="maximumtabid" />				<div class="content_form_text">Name:</div>		<div class="content_form_input"><input class="content_form_input_field" type="text" name="tabbar_name" value="{TABBAR_NAME}" /></div>		<div class="content_form_details">{LANG:helptext_tabbar_name}</div>				<h2>Tabs</h2>				<div id="tab_container_global"></div>				<a href="javascript:void(0)" onclick="createNewTab()"><img src="templates/default/grafix/plus.png"> {LANG:createnewtab}</a>			<div class="content_submit_button">			<input type="submit" value="{LANG:submit}" />		</div>	</form>		<script type="text/javascript"><!--	{FOR_TABS	createTab({TAB_ID}, {TAB_VIEW_ID}, {DEFAULT_TAB}, '{TAB_ICON}');	FOR_TABS}	--></script>